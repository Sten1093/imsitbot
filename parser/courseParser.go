package parser

import (
	"fmt"
	"github.com/xuri/excelize/v2"
	"strings"
	"sync"
	"time"
)

type Group struct {
	ID        int
	TGName    string
	FileName  string
	CourseNum string
}

// ะะพะฝััะฐะฝัั
const (
	HigherEd    = "๐ะัััะตะต"
	SecondaryEd = "๐ะกัะตะดะฝะตะต"
	WeekFormat  = "๐ ะะตะดะตะปั"
	DayFormat   = "๐ ะะตะฝั ๐โโ๏ธ"
)

// ะะปะพะฑะฐะปัะฝัะน ะบัั ะณััะฟะฟ
var (
	groups     []Group
	groupsMap  map[string]*Group
	groupsInit sync.Once
)

func initGroups() {
	groups = []Group{
		{1, "๐ป24-ะะะข-01", "24-ะะะข-01", "๐ค 1 ะบััั"},
		{1, "๐จโ๐ป24-ะะ-01", "24-ะะ-01", "๐ค 1 ะบััั"},
		{1, "๐ฉโ๐ป24-ะะ-02", "24-ะะ-02", "๐ค 1 ะบััั"},
		{1, "๐ฌ24-ะะะฝะถ-01", "24-ะะะฝะถ-01", "๐ค 1 ะบััั"},
		{1, "โ๏ธ24-ะะะฝะถ-02", "24-ะะะฝะถ-02", "๐ค 1 ะบััั"},
		{1, "๐๏ธ24-ะะ-01", "24-ะะ-01", "๐ค 1 ะบััั"},
		{1, "๐งฐ24-ะะ-02", "24-ะะ-02", "๐ค 1 ะบััั"},
		{1, "๐ฉ24-ะะ-03", "24-ะะ-03", "๐ค 1 ะบััั"},
		{1, "๐24-ะะ-04", "24-ะะ-04", "๐ค 1 ะบััั"},
		{1, "๐24-ะะ-01", "24-ะะ-01", "๐ค 1 ะบััั"},
		{1, "๐ง24-ะั-01", "24-ะั-01", "๐ค 1 ะบััั"},
		{1, "๐24-ะะกะ-01", "24-ะะกะ-01", "๐ค 1 ะบััั"},
		{1, "๐24-ะะะฃ-01", "24-ะะะฃ-01", "๐ค 1 ะบััั"},
		{1, "๐24-ะ-01", "24-ะ-01", "๐ค 1 ะบััั"},
		{1, "๐ฐ24-ะญะ-01", "24-ะญะ-01", "๐ค 1 ะบััั"},
		{1, "โ๏ธ24-ะฎ-01", "24-ะฎ-01", "๐ค 1 ะบััั"},
		{1, "๐ฟ24-ะะ-02", "24-ะะ-02 (ะััะพัะธั ะธ ะฟัะฐะฒะพ)", "๐ค 1 ะบััั"},

		{2, "๐ป23-ะะะข-01", "23-ะะะข-01", "๐ 2 ะบััั"},
		{2, "๐จโ๐ป23-ะะ-01", "23-ะะ-01", "๐ 2 ะบััั"},
		{2, "๐ง23-ะะ-01", "23-ะะ-01", "๐ 2 ะบััั"},
		{2, "โ๏ธ23-ะะ-02", "23-ะะ-02", "๐ 2 ะบััั"},
		{2, "๐๏ธ23-ะะ-01", "23-ะะ-01", "๐ 2 ะบััั"},
		{2, "๐ฅ๏ธ23-ะะ-01", "23-ะะ-01", "๐ 2 ะบััั"},
		{2, "๐23-ะะกะ-01", "23-ะะกะ-01", "๐ 2 ะบััั"},
		{2, "๐23-ะะะฃ-01", "23-ะะะฃ-01", "๐ 2 ะบััั"},
		{2, "๐23-ะ-01", "23-ะ-01", "๐ 2 ะบััั"},
		{2, "๐ฐ23-ะญะ-01", "23-ะญะ-01", "๐ 2 ะบััั"},

		{3, "๐ป22-ะะะข-01", "22-ะะะข-01", "๐ง 3 ะบััั"},
		{3, "๐จโ๐ป22-ะะ-01", "22-ะะ-01", "๐ง 3 ะบััั"},
		{3, "๐ง22-ะะ-01", "22-ะะ-01", "๐ง 3 ะบััั"},
		{3, "โ๏ธ22-ะะ-02", "22-ะะ-02", "๐ง 3 ะบััั"},
		{3, "๐22-ะะกะ-01", "22-ะะกะ-01", "๐ง 3 ะบััั"},
		{3, "๐22-ะะะฃ-01", "22-ะะะฃ-01", "๐ง 3 ะบััั"},
		{3, "๐22-ะ-01", "22-ะ-01", "๐ง 3 ะบััั"},
		{3, "๐ฐ22-ะญะ-01", "22-ะญะ-01", "๐ง 3 ะบััั"},
		{3, "๐ฅ๏ธ22-ะะ-01", "22-ะะ-01", "๐ง 3 ะบััั"},
		{3, "๐๏ธ22-ะะ-01", "22-ะะ-01", "๐ง 3 ะบััั"},

		{4, "๐ป21-ะะะข-01", "21-ะะะข-01", "๐ 4 ะบััั"},
		{4, "๐จโ๐ป21-ะะ-01", "21-ะะ-01", "๐ 4 ะบััั"},
		{4, "๐ง21-ะะ-01", "21-ะะ-01", "๐ 4 ะบััั"},
		{4, "โ๏ธ21-ะะ-02", "21-ะะ-02", "๐ 4 ะบััั"},
		{4, "๐21-ะะ-01", "21-ะะ-01", "๐ 4 ะบััั"},
		{4, "๐ฅ๏ธ21-ะะ-01", "21-ะะ-01", "๐ 4 ะบััั"},
		{4, "๐21-ะะกะ-01", "21-ะะกะ-01", "๐ 4 ะบััั"},
		{4, "๐21-ะะะฃ-01", "21-ะะะฃ-01", "๐ 4 ะบััั"},
		{4, "๐21-ะ-01", "21-ะ-01", "๐ 4 ะบััั"},
		{4, "๐ค21-ะฃะ-01", "21-ะฃะ-01", "๐ 4 ะบััั"},
		{4, "๐ฐ21-ะญะ-01", "21-ะญะ-01", "๐ 4 ะบััั"},
		{4, "๐ฅธ21-ะะ-01", "21-ะะ-01", "๐ 4 ะบััั"},

		{5, "๐ฅ๏ธ20-ะะ-01", "20-ะะ-01", "๐ซ 5 ะบััั"},
		{5, "๐ฅ๏ธ20-ะะ-02", "20-ะะ-02", "๐ซ 5 ะบััั"},

		{7, "๐24-ะกะะ-ะัะ-01", "24-ะกะะ-ะัะ-01", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะัะ-02", "24-ะกะะ-ะัะ-02", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะัะ-03", "24-ะกะะ-ะัะ-03", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะัะ-04", "24-ะกะะ-ะัะ-04", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะัะ-05", "24-ะกะะ-ะัะ-05", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะัะ-06", "24-ะกะะ-ะัะ-06", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะัะ-07", "24-ะกะะ-ะัะ-07", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะัะ-08", "24-ะกะะ-ะัะ-08", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะัะ-09", "24-ะกะะ-ะัะ-09", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะัะ-10", "24-ะกะะ-ะัะ-10", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะะฝ-01", "24-ะกะะ-ะะฝ-01", "๐ค 1 ะบััั"},
		{7, "๐ฅ24-ะกะะ-ะะฝ-02", "24-ะกะะ-ะะฝ-02", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะะฝ-03", "24-ะกะะ-ะะฝ-03", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะะฝ-04", "24-ะกะะ-ะะฝ-04", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะขะะ-01", "24-ะกะะ-ะขะะ-01", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะขะะ-02", "24-ะกะะ-ะขะะ-02", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะขะะ-03", "24-ะกะะ-ะขะะ-03", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะขะะ-04", "24-ะกะะ-ะขะะ-04", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะขะะค-01", "24-ะกะะ-ะขะะค-01", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะขะะค-02", "24-ะกะะ-ะขะะค-02", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะะ-01", "24-ะกะะ-ะะ-01", "๐ค 1 ะบััั"},
		{7, "๐ฐ24-ะกะะ-ะะะ-01", "24-ะกะะ-ะะะ-01", "๐ค 1 ะบััั"},
		{7, "๐ฐ24-ะกะะ-ะะะ-02", "24-ะกะะ-ะะะ-02", "๐ค 1 ะบััั"},
		{7, "๐ป24-ะกะะ-ะ-01", "24-ะกะะ-ะ-01", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะ-02", "24-ะกะะ-ะ-02", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะ-03", "24-ะกะะ-ะ-03", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะ-04", "24-ะกะะ-ะ-04", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะขะธะ-01", "24-ะกะะ-ะขะธะ-01", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะขะธะ-02", "24-ะกะะ-ะขะธะ-02", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะขะธะ-03", "24-ะกะะ-ะขะธะ-03", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะขะธะ-04", "24-ะกะะ-ะขะธะ-04", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะะฃ-01", "24-ะกะะ-ะะฃ-01", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะะฃ-02", "24-ะกะะ-ะะฃ-02", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะะกะธะ-01", "24-ะกะะ-ะะกะธะ-01", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะะกะธะ-02", "24-ะกะะ-ะะกะธะ-02", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะะกะธะ-03", "24-ะกะะ-ะะกะธะ-03", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะะกะธะ-04", "24-ะกะะ-ะะกะธะ-04", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะะกะธะ-05", "24-ะกะะ-ะะกiะ-05", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะะกะธะ-06", "24-ะกะะ-ะะกiะ-06", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะะกะธะ-07", "24-ะกะะ-ะะกiะ-07", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะะกะธะ-08", "24-ะกะะ-ะะกiะ-08", "๐ค 1 ะบััั"},
		{7, "๐ป24-ะกะะ-ะะะะะก-01", "24-ะกะะ-ะะะะะก-01", "๐ค 1 ะบััั"},
		{7, "๐ป24-ะกะะ-ะะะะะก-02", "24-ะกะะ-ะะะะะก-02", "๐ค 1 ะบััั"},
		{7, "๐ป24-ะกะะ-ะะะะะก-03", "24-ะกะะ-ะะะะะก-03", "๐ค 1 ะบััั"},
		{7, "๐จโ๐ป24-ะกะะ-ะกะธะกะ-01", "24-ะกะะ-ะกะธะกะ-01", "๐ค 1 ะบััั"},
		{7, "๐จโ๐ป24-ะกะะ-ะกะธะกะ-02", "24-ะกะะ-ะกะธะกะ-02", "๐ค 1 ะบััั"},
		{7, "๐จโ๐ป24-ะกะะ-ะกะธะกะ-03", "24-ะกะะ-ะกะธะกะ-03", "๐ค 1 ะบััั"},
		{7, "๐พ24-ะกะะ-ะะ-01", "24-ะกะะ-ะะ-01", "๐ค 1 ะบััั"},
		{7, "๐ฉบ24-ะกะะ-ะะะ-01", "24-ะกะะ-ะะะ-01", "๐ค 1 ะบััั"},
		{7, "๐ฉบ24-ะกะะ-ะะะ-02", "24-ะกะะ-ะะะ-02", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะะ-01", "24-ะกะะ-ะะ-01", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะะ-02", "24-ะกะะ-ะะ-02", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะะ-03", "24-ะกะะ-ะะ-03", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะะ-04", "24-ะกะะ-ะะ-04", "๐ค 1 ะบััั"},
		{7, "๐24-ะกะะ-ะะ-05", "24-ะกะะ-ะะ-05", "๐ค 1 ะบััั"},
		{7, "โ๏ธ24-ะกะะ-ะค-01", "24-ะกะะ-ะค-01", "๐ค 1 ะบััั"},
		{7, "โ๏ธ24-ะกะะ-ะค-02", "24-ะกะะ-ะค-02", "๐ค 1 ะบััั"},
		{7, "๐ฐ24-ะกะะ-ะญะะฃ-01", "24-ะกะะ-ะญะะฃ-01", "๐ค 1 ะบััั"},
		{7, "โ๏ธ24-ะกะะ-ะฎ-01", "24-ะกะะ-ะฎ-01", "๐ค 1 ะบััั"},
		{7, "โ๏ธ24-ะกะะ-ะฎ-02", "24-ะกะะ-ะฎ-02", "๐ค 1 ะบััั"},

		{8, "๐24-ะกะะ-ะะฝ-05", "24-ะกะะ-ะะฝ-05", "๐ 2 ะบััั"},
		{8, "๐24-ะกะะ-ะขะะ-05", "24-ะกะะ-ะขะะ-05", "๐ 2 ะบััั"},
		{8, "๐24-ะกะะ-ะขะธะ-06", "24-ะกะะ-ะขะธะ-06", "๐ 2 ะบััั"},
		{8, "๐24-ะกะะ-ะะฃ-03", "24-ะกะะ-ะะฃ-03", "๐ 2 ะบััั"},
		{8, "๐24-ะกะะ-ะะกะธะ-09", "24-ะกะะ-ะะกะธะ-09", "๐ 2 ะบััั"},
		{8, "๐24-ะกะะ-ะะกะธะ-10", "24-ะกะะ-ะะกะธะ-10", "๐ 2 ะบััั"},
		{8, "๐ป24-ะกะะ-ะะะะะก-04", "24-ะกะะ-ะะะะะก-04", "๐ 2 ะบััั"},
		{8, "๐24-ะกะะ-ะะ-06", "24-ะกะะ-ะะ-06", "๐ 2 ะบััั"},
		{8, "โ๏ธ24-ะกะะ-ะค-03", "24-ะกะะ-ะค-03", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะัะ-01", "23-ะกะะ-ะัะ-01", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะัะ-02", "23-ะกะะ-ะัะ-02", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะัะ-03", "23-ะกะะ-ะัะ-03", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะัะ-04", "23-ะกะะ-ะัะ-04", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะัะ-05", "23-ะกะะ-ะัะ-05", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะัะ-06", "23-ะกะะ-ะัะ-06", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะัะ-07", "23-ะกะะ-ะัะ-07", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะัะ-08", "23-ะกะะ-ะัะ-08", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะัะ-09", "23-ะกะะ-ะัะ-09", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะัะ-10", "23-ะกะะ-ะัะ-10", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะะฝ-01", "23-ะกะะ-ะะฝ-01", "๐ 2 ะบััั"},
		{8, "๐ฅ23-ะกะะ-ะะฝ-02", "23-ะกะะ-ะะฝ-02", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะะฝ-03", "23-ะกะะ-ะะฝ-03", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะะฝ-04", "23-ะกะะ-ะะฝ-04", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะขะะ-01", "23-ะกะะ-ะขะะ-01", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะขะะ-02", "23-ะกะะ-ะขะะ-02", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะขะะ-03", "23-ะกะะ-ะขะะ-03", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะขะะค-01", "23-ะกะะ-ะขะะค-01", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะขะะค-02", "23-ะกะะ-ะขะะค-02", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะขะะค-03", "23-ะกะะ-ะขะะค-03", "๐ 2 ะบััั"},
		{8, "๐ฐ23-ะกะะ-ะะะ-01", "23-ะกะะ-ะะะ-01", "๐ 2 ะบััั"},
		{8, "๐ฐ23-ะกะะ-ะะฝะ-02", "23-ะกะะ-ะะะ-02", "๐ 2 ะบััั"},
		{8, "๐ฐ23-ะกะะ-ะะะ-03", "23-ะกะะ-ะะะ-03", "๐ 2 ะบััั"},
		{8, "๐ป23-ะกะะ-ะ-01", "23-ะกะะ-ะ-01", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะ-02", "23-ะกะะ-ะ-02", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะ-03", "23-ะกะะ-ะ-03", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะขะธะ-01", "23-ะกะะ-ะขะธะ-01", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะขะธะ-02", "23-ะกะะ-ะขะธะ-02", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะะฃ-01", "23-ะกะะ-ะะฃ-01", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะะฃ-02", "23-ะกะะ-ะะฃ-02", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะะกะธะ-01", "23-ะกะะ-ะะกะธะ-01", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะะกะธะ-02", "23-ะกะะ-ะะกะธะ-02", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะะกะธะ-03", "23-ะกะะ-ะะกะธะ-03", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะะกะธะ-04", "23-ะกะะ-ะะกะธะ-04", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะะกะธะ-05", "23-ะกะะ-ะะกะธะ-05", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะะกะธะ-06", "23-ะกะะ-ะะกะธะ-06", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะะกะธะ-07", "23-ะกะะ-ะะกะธะ-07", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะะกะธะ-08", "23-ะกะะ-ะะกะธะ-08", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะะกะธะ-09", "23-ะกะะ-ะะกะธะ-09", "๐ 2 ะบััั"},
		{8, "๐23-ะกะะ-ะะกะธะ-10", "23-ะกะะ-ะะกะธะ-10", "๐ 2 ะบััั"},
		{8, "๐ป23-ะกะะ-ะะะะะก-01", "23-ะกะะ-ะะะะะก-01", "๐ 2 ะบััั"},
		{8, "๐ป23-ะกะะ-ะะะะะก-02", "23-ะกะะ-ะะะะะก-02", "๐ 2 ะบััั"},
		{8, "๐ป23-ะกะะ-ะะะะะก-03", "23-ะกะะ-ะะะะะก-03", "๐ 2 ะบััั"},
		{8, "๐จโ๐ป23-ะกะะ-ะกะธะกะ-01", "23-ะกะะ-ะกะธะกะ-01", "๐ 2 ะบััั"},
		{8, "๐จโ๐ป23-ะกะะ-ะกะธะกะ-02", "23-ะกะะ-ะกะธะกะ-02", "๐ 2 ะบััั"},
		{8, "๐จโ๐ป23-ะกะะ-ะกะธะกะ-03", "23-ะกะะ-ะกะธะกะ-03", "๐ 2 ะบััั"},
		{8, "๐พ23-ะกะะ-ะะ-01", "23-ะกะะ-ะะ-01", "๐ 2 ะบััั"},

		{9, "๐23-ะกะะ-ะะฝ-05", "23-ะกะะ-ะะฝ-05", "๐ง 3 ะบััั"},
		{9, "๐23-ะกะะ-ะขะะค-04", "23-ะกะะ-ะขะะค-04", "๐ง 3 ะบััั"},
		{9, "๐ป23-ะกะะ-ะ-04", "23-ะกะะ-ะ-04", "๐ง 3 ะบััั"},
		{9, "๐ง23-ะกะะ-ะกะธะกะ-04", "23-ะกะะ-ะกะธะกะ-04", "๐ง 3 ะบััั"},
		{9, "๐พ23-ะกะะ-ะะ-02", "23-ะกะะ-ะะ-02", "๐ง 3 ะบััั"},
		{9, "๐23-ะกะะ-ะะ-06", "23-ะกะะ-ะะ-06", "๐ง 3 ะบััั"},
		{9, "๐23-ะกะะ-ะะ-07", "23-ะกะะ-ะะ-07", "๐ง 3 ะบััั"},
		{9, "โ๏ธ23-ะกะะ-ะค-02", "23-ะกะะ-ะค-02", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะัะ-01", "22-ะกะะ-ะัะ-01", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะัะ-02", "22-ะกะะ-ะัะ-02", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะัะ-03", "22-ะกะะ-ะัะ-03", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะัะ-04", "22-ะกะะ-ะัะ-04", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะัะ-05", "22-ะกะะ-ะัะ-05", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะัะ-06", "22-ะกะะ-ะัะ-06", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะะฝ-01", "22-ะกะะ-ะะฝ-01", "๐ง 3 ะบััั"},
		{9, "๐ฅ22-ะกะะ-ะะฝ-02", "22-ะกะะ-ะะฝ-02", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะะฝ-03", "22-ะกะะ-ะะฝ-03", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะะฝ-04", "22-ะกะะ-ะะฝ-04", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะขะะค-01", "22-ะกะะ-ะขะะค-01", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะขะะค-02", "22-ะกะะ-ะขะะค-02", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะขะะค-03", "22-ะกะะ-ะขะะค-03", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะขะะค-04", "22-ะกะะ-ะขะะค-04", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะขะะ-01", "22-ะกะะ-ะขะะ-01", "๐ง 3 ะบััั"},
		{9, "๐ค22-ะกะะ-ะะ-01", "22-ะกะะ-ะะ-01", "๐ง 3 ะบััั"},
		{9, "๐ฐ22-ะกะะ-ะะะ-01", "22-ะกะะ-ะะะ-01", "๐ง 3 ะบััั"},
		{9, "๐ฐ22-ะกะะ-ะะะ-02", "22-ะกะะ-ะะะ-02", "๐ง 3 ะบััั"},
		{9, "๐ฐ22-ะกะะ-ะะะ-03", "22-ะกะะ-ะะะ-03", "๐ง 3 ะบััั"},
		{9, "๐ป22-ะกะะ-ะ-01", "22-ะกะะ-ะ-01", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะ-02", "22-ะกะะ-ะ-02", "๐ง 3 ะบััั"},
		{9, "๐ง22-ะกะะ-ะข-01", "22-ะกะะ-ะข-01", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะะะ-01", "22-ะกะะ-ะะะ-01", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะะะ-02", "22-ะกะะ-ะะะ-02", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะะะ-03", "22-ะกะะ-ะะะ-03", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะะกะธะ-01", "22-ะกะะ-ะะกะธะ-01", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะะกะธะ-02", "22-ะกะะ-ะะกะธะ-02", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะะกะธะ-03", "22-ะกะะ-ะะกะธะ-03", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะะกะธะ-04", "22-ะกะะ-ะะกะธะ-04", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะะกะธะ-05", "22-ะกะะ-ะะกะธะ-05", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะะกะธะ-06", "22-ะกะะ-ะะกะธะ-06", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะะกะธะ-07", "22-ะกะะ-ะะกะธะ-07", "๐ง 3 ะบััั"},
		{9, "๐ฐ22-ะกะะ-ะะขะะ-01", "22-ะกะะ-ะะขะะ-01", "๐ง 3 ะบััั"},
		{9, "๐ฐ22-ะกะะ-ะะขะะ-02", "22-ะกะะ-ะะขะะ-02", "๐ง 3 ะบััั"},
		{9, "๐ฐ22-ะกะะ-ะะขะะ-03", "22-ะกะะ-ะะขะะ-03", "๐ง 3 ะบััั"},
		{9, "๐จโ๐ป22-ะกะะ-ะกะธะกะ-01", "22-ะกะะ-ะกะธะกะ-01", "๐ง 3 ะบััั"},
		{9, "๐จโ๐ป22-ะกะะ-ะกะธะกะ-02", "22-ะกะะ-ะกะธะกะ-02", "๐ง 3 ะบััั"},
		{9, "๐จโ๐ป22-ะกะะ-ะกะธะกะ-03", "22-ะกะะ-ะกะธะกะ-03", "๐ง 3 ะบััั"},
		{9, "๐จโ๐ป22-ะกะะ-ะกะธะกะ-04", "22-ะกะะ-ะกะธะกะ-04", "๐ง 3 ะบััั"},
		{9, "๐พ22-ะกะะ-ะะ-01", "22-ะกะะ-ะะ-01", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะะ-01", "22-ะกะะ-ะะ-01", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะะ-02", "22-ะกะะ-ะะ-02", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะะ-03", "22-ะกะะ-ะะ-03", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะะ-04", "22-ะกะะ-ะะ-04", "๐ง 3 ะบััั"},
		{9, "๐22-ะกะะ-ะะ-05", "22-ะกะะ-ะะ-05", "๐ง 3 ะบััั"},
		{9, "โ๏ธ22-ะกะะ-ะค-01", "22-ะกะะ-ะค-01", "๐ง 3 ะบััั"},
		{9, "๐ข22-ะกะะ-ะญะะฃ-01", "22-ะกะะ-ะญะะฃ-01", "๐ง 3 ะบััั"},

		{10, "๐22-ะกะะ-ะะฝ-05", "22-ะกะะ-ะะฝ-05", "๐ 4 ะบััั"},
		{10, "๐ป22-ะกะะ-ะ-03", "22-ะกะะ-ะ-03", "๐ 4 ะบััั"},
		{10, "๐21-ะกะะ-ะัะ-01", "21-ะกะะ-ะัะ-01", "๐ 4 ะบััั"},
		{10, "๐21-ะกะะ-ะัะ-03", "21-ะกะะ-ะัะ-03", "๐ 4 ะบััั"},
		{10, "๐21-ะกะะ-ะัะ-04", "21-ะกะะ-ะัะ-04", "๐ 4 ะบััั"},
		{10, "๐21-ะกะะ-ะะฝ-01", "21-ะกะะ-ะะฝ-01", "๐ 4 ะบััั"},
		{10, "๐ฅ๏ธ21-ะกะะ-ะะฝ-02", "21-ะกะะ-ะะฝ-02", "๐ 4 ะบััั"},
		{10, "๐21-ะกะะ-ะะฝ-03", "21-ะกะะ-ะะฝ-03", "๐ 4 ะบััั"},
		{10, "๐21-ะกะะ-ะะฝ-04", "21-ะกะะ-ะะฝ-04", "๐ 4 ะบััั"},
		{10, "๐21-ะกะะ-ะขะะ-01", "21-ะกะะ-ะขะะ-01", "๐ 4 ะบััั"},
		{10, "๐ค21-ะกะะ-ะะ-01", "21-ะกะะ-ะะ-01", "๐ 4 ะบััั"},
		{10, "๐ฐ21-ะกะะ-ะะะ-01,02 22-ะกะะ-ะะะ-04", "21-ะกะะ-ะะะ-01,02 22-ะกะะ-ะะะ-04", "๐ 4 ะบััั"},
		{10, "๐ป21-ะกะะ-ะ-01", "21-ะกะะ-ะ-01", "๐ 4 ะบััั"},
		{10, "๐21-ะกะะ-ะ-02", "21-ะกะะ-ะ-02", "๐ 4 ะบััั"},
		{10, "๐21-ะกะะ-ะ-03", "21-ะกะะ-ะ-03", "๐ 4 ะบััั"},
		{10, "๐21-ะกะะ-ะะกะธะ-01,02,03 22-ะกะะ-ะะกะธะ-08,09,10", "21-ะกะะ-ะะกะธะ-01,02,03 22-ะกะะ-ะะกะธะ-08,09,10", "๐ 4 ะบััั"},
		{10, "๐ค21-ะกะะ-ะะกะธะ-04,05,06", "21-ะกะะ-ะะกะธะ-04,05,06", "๐ 4 ะบััั"},
		{10, "๐ฐ21-ะกะะ-ะะขะะ-01,02 22-ะกะะ-ะะขะะ-04", "21-ะกะะ-ะะขะะ-01,02 22-ะกะะ-ะะขะะ-04", "๐ 4 ะบััั"},
		{10, "๐ฅธ21-ะกะะ-ะกะธะกะ-01,02", "21-ะกะะ-ะกะธะกะ-01,02", "๐ 4 ะบััั"},
	}
	groupsMap = make(map[string]*Group, len(groups))
	for i := range groups {
		groupsMap[groups[i].TGName] = &groups[i]
	}
}

func GetGroups() []Group {
	groupsInit.Do(initGroups)
	return groups
}

func FindGroup(tgName string) *Group {
	groupsInit.Do(initGroups)
	return groupsMap[tgName]
}
func FindGroupName(surname string) bool {
	for _, group := range GetGroups() {
		if strings.EqualFold(group.TGName, surname) { // EqualFold ััะธััะฒะฐะตั ัะตะณะธััั
			return true
		}
	}
	return false
}

func GenerateResponseFromTable(fieldPosStart, fieldPosEnd, groupName int, rows [][]string) []string {
	var result []string
	for i := fieldPosEnd; i <= fieldPosStart && i < len(rows); i++ {
		if len(rows[i]) <= groupName || rows[i][groupName] == "" {
			continue
		}
		entry := fmt.Sprintf("%s: %s", rows[i][1], rows[i][groupName])
		if trimmed := strings.TrimSpace(entry); trimmed != "" {
			result = append(result, trimmed)
		}
	}
	if len(result) == 0 {
		return []string{"ะััะพะดะฝะพะน"}
	}
	return result
}

func Tab(TGName, format, education string) string {
	group := FindGroup(TGName)
	if group == nil {
		return fmt.Sprintf("ะััะฟะฟะฐ %s ะฝะต ะฝะฐะนะดะตะฝะฐ", TGName)
	}

	fileName := getFileName(education, group.CourseNum)
	if fileName == "" {
		return "ะะตะฟะพะดะดะตัะถะธะฒะฐะตะผัะน ัะธะฟ ะพะฑัะฐะทะพะฒะฐะฝะธั ะธะปะธ ะบััั"
	}

	f, err := excelize.OpenFile(fileName)
	if err != nil {
		return fmt.Sprintf("ะัะธะฑะบะฐ ะพัะบัััะธั ัะฐะนะปะฐ: %v", err)
	}
	danger := f.Close()
	if danger != nil {
		return fmt.Sprintf("ะัะธะฑะบะฐ ะทะฐะบัััะธั ัะฐะนะปะฐ: %v", danger)
	}

	_, _, week, _ := NowTime()
	rows, err := f.GetRows(week)
	if err != nil {
		return fmt.Sprintf("ะัะธะฑะบะฐ ััะตะฝะธั ะดะฐะฝะฝัั: %v", err)
	}

	groupName := findGroupColumn(rows[0], group.FileName)
	if groupName == -1 {
		return fmt.Sprintf("ะััะฟะฟะฐ %v ะฝะต ะฝะฐะนะดะตะฝะฐ ะฒ ัะฐะนะปะต", group)
	}

	return generateSchedule(format, groupName, rows)
}

func getFileName(education, courseNum string) string {
	courseFiles := map[string]map[string]string{
		HigherEd: {
			"๐ค 1 ะบััั": "resources/1_course.xlsx",
			"๐ 2 ะบััั": "resources/2_course.xlsx",
			"๐ง 3 ะบััั": "resources/3_course.xlsx",
			"๐ 4 ะบััั": "resources/4_course.xlsx",
			"๐ซ 5 ะบััั": "resources/5_course.xlsx",
		},
		SecondaryEd: {
			"๐ค 1 ะบััั": "resources/ะกะะ_1_course.xlsx",
			"๐ 2 ะบััั": "resources/ะกะะ_2_course.xlsx",
			"๐ง 3 ะบััั": "resources/ะกะะ_3_course.xlsx",
			"๐ 4 ะบััั": "resources/ะกะะ_4_course.xlsx",
		},
	}
	return courseFiles[education][courseNum]
}

func findGroupColumn(header []string, groupName string) int {
	for i, cell := range header {
		if cell == groupName {
			return i
		}
	}
	return -1
}

func generateSchedule(format string, groupName int, rows [][]string) string {
	dayRanges := map[time.Weekday][2]int{
		time.Monday:    {1, 14},
		time.Tuesday:   {15, 28},
		time.Wednesday: {29, 42},
		time.Thursday:  {43, 56},
		time.Friday:    {57, 70},
		time.Saturday:  {71, 84},
	}
	dayNames := map[time.Weekday]string{
		time.Monday:    "ะะพะฝะตะดะตะปัะฝะธะบ",
		time.Tuesday:   "ะัะพัะฝะธะบ",
		time.Wednesday: "ะกัะตะดะฐ",
		time.Thursday:  "ะงะตัะฒะตัะณ",
		time.Friday:    "ะััะฝะธัะฐ",
		time.Saturday:  "ะกัะฑะฑะพัะฐ",
	}

	switch format {
	case WeekFormat:
		var result strings.Builder
		result.Grow(1024) // ะัะตะดะฒะฐัะธัะตะปัะฝะพ ะฒัะดะตะปัะตะผ ะฟะฐะผััั
		for day := time.Monday; day <= time.Saturday; day++ {
			ranges := dayRanges[day]
			result.WriteString("\n" + dayNames[day] + "\n")
			result.WriteString(strings.Join(GenerateResponseFromTable(ranges[1], ranges[0], groupName, rows), "\n"))
			result.WriteString("\n----------\n")
		}
		return result.String()

	case DayFormat:
		_, day, _, _ := NowTime()
		if day == time.Sunday {
			return "ะฃ ัะตะฑั ะฒััะพะดะฝะพะน ;)"
		}
		ranges := dayRanges[day]
		var result strings.Builder
		result.WriteString(dayNames[day] + "\n----------\n")
		result.WriteString(strings.Join(GenerateResponseFromTable(ranges[1], ranges[0], groupName, rows), "\n"))
		return result.String()

	default:
		return "ะะต ะฝะฐัะตะป ะฝัะถะฝัั ะดะฐะฝะฝัั :("
	}
}
